<h2 class="carousel-title">Bestsellers</h2>

<div class="carousel-wrapper">
  <button class="nav prev" (click)="scrollLeft(carousel)">‹</button>

  <div class="carousel" #carousel>
    <div class="product-card" *ngFor="let product of products | searchFilter:searchTerm">
      <img [src]="product.image" alt="{{ product.title }}" class="product-image" />

      <div class="product-details">
        <h3>{{ product.title }}</h3>
        <p class="description">{{ product.description }}</p>
        <div class="price-rating">
          <span>₹{{ product.price }}</span>
          <span>⭐ {{ product.rating }}</span>
        </div>

        <div class="button-group">
          <li *ngIf="isLoggedIn">
            <a routerLink="/cart" class="btn btn-light rounded-pill shadow-sm px-2 py-2 text-uppercase fw-semibold border border-secondary" style="transition: all 0.3s ease;">
              Buy Now
            </a>
          </li>

          <ng-container *ngIf="!isInCart(product) || !isLoggedIn; else cartControls">
            <button type="button" class="cart-button" (click)="isLoggedIn ? addToCart(product) : loginmodal()">Add to Cart</button>
          </ng-container>

          <ng-template #cartControls>
            <div class="cart-controls">
              <button type="button" class="qty-button" (click)="isLoggedIn ? decreaseQuantity(product) : loginmodal()">−</button>
              <span class="qty-display">{{ getQuantity(product) }}</span>
              <button type="button" class="qty-button" (click)="isLoggedIn ? increaseQuantity(product) : loginmodal()">+</button>
              <button type="button" class="remove-button" (click)="isLoggedIn ? removeFromCart(product) : loginmodal()">Remove</button>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>

  <button class="nav next" (click)="scrollRight(carousel)">›</button>
</div>
